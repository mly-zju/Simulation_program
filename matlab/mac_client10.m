clc;
x=0:10:80;
zigbee_tx=zeros(1,9);
zigbee_collision=zeros(1,9);
zigbee_succceed=zeros(1,9);
zigbee_throughput=zeros(1,9);
zigbee_delay=zeros(1,9);
zigbee_collison_p=zeros(1,9);
wifi_tx=zeros(1,9);
wifi_collision=zeros(1,9);
wifi_succceed=zeros(1,9);
wifi_throughput=zeros(1,9);
wifi_delay=zeros(1,9);
wifi_collision_p=zeros(1,9);

zigbee_tx2=zeros(1,9);
zigbee_collision2=zeros(1,9);
zigbee_succceed2=zeros(1,9);
zigbee_throughput2=zeros(1,9);
zigbee_delay2=zeros(1,9);
zigbee_collison_p2=zeros(1,9);
wifi_tx2=zeros(1,9);
wifi_collision2=zeros(1,9);
wifi_succceed2=zeros(1,9);
wifi_throughput2=zeros(1,9);
wifi_delay2=zeros(1,9);
wifi_collison_p2=zeros(1,9);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
wifi_tx=[0 11598 26356 43891 62077 78198 92265 92890 92890];              
wifi_collision=[0 1611 6425 14044 22329 28603 33619 34025 34925];
wifi_succeed=wifi_tx-wifi_collision;
wifi_collision_p=wifi_collision./wifi_tx;
wifi_collision_p(1)=0;
wifi_delay=[0 0.775358 2.96242 5.75975 8.09341 9.73026 12.2534 14.3064 15.8064]/1000;
wifi_throughput=[0 1.9974 3.9862 5.9694 7.9496 9.919 11.729 11.7728 11.8228];

zigbee_tx=[0 12477 13534 14036 17068 20519 6234 5014 5014];
zigbee_collision=[0 3011 4095 4633 7646 11103 5990 4962 5262];
zigbee_succeed=zigbee_tx-zigbee_collision;
zigbee_collision_p=zigbee_collision./zigbee_tx;
zigbee_collision_p(1)=0;
zigbee_delay=[0 10.0696 20.5256 33.8309 59.3115 91.4796 4095.14 19219.2 29219.2]/1000;
zigbee_throughput=[0 586892 585218 582986 584164 583792 15128 3224 3024];
zigbee_throughput=zigbee_throughput./100000000;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
wifi_tx2=[0 9998 23360 41040 56926 71203 83190 90409 90409];
wifi_collision2=[0 476 4063 12115 19008 24309 28435 31661 32161];
wifi_succeed2=wifi_tx2-wifi_collision2;
wifi_collision_p2=wifi_collision2./wifi_tx2;
wifi_collision_p2(1)=0;
wifi_delay2=[0 0.420751 2.24582 5.07202 7.52234 8.89766 10.61019 13.0281 14.4281]/1000;
wifi_throughput2=[0 1.9344 3.8594 5.7848 7.5834 9.3788 11.1508 11.7794 11.8794];

zigbee_tx2=[0 310 587 920 1178 1426 1674 1961 1961];
zigbee_collision2=[0 12 32 106 166 225 322 420 490];
zigbee_succeed2=zigbee_tx2-zigbee_collision2;
zigbee_collision_p2=zigbee_collision2./zigbee_tx2;
zigbee_collision_p2(1)=0;
zigbee_delay2=[0 4.10027 4.18076 5.18912 5.43547 6.04407 6.75015 7.56945 8.56945]/1000;
zigbee_throughput2=[0 18476 34410 50468 62744 74462 83824 95542 99542];
zigbee_throughput2=zigbee_throughput2./100000000;


figure(1);
subplot(2,1,1);
hold on;
grid on;
plot(x,wifi_collision_p,'-*r');
plot(x,wifi_collision_p2,'-ob');
legend('wifi system without TDM','wifi system with TDM','location','northwest');
xlabel('client number');
ylabel('collision probability');
subplot(2,1,2);
hold on;
grid on;
plot(x,zigbee_collision_p,'-*r');
plot(x,zigbee_collision_p2,'-ob');
legend('zigbee system without TDM','zigbee system with TDM','location','northwest');
xlabel('client number');
ylabel('collision probability');
figure(2);
hold on;
grid on;
subplot(2,1,1);
hold on;
grid on;
plot(x,wifi_throughput,'-*r');
plot(x,wifi_throughput2,'-ob');
xlabel('load(pk/s)');
ylabel('Throughput (Mbps/s)');
legend('wifi system without TDM','wifi system with TDM','location','northwest');
subplot(2,1,2);
hold on;
grid on;
plot(x,zigbee_throughput,'-*r');
plot(x,zigbee_throughput2,'-ob');
xlabel('load(pk/s)');
ylabel('Throughput (Mbps/s)');
legend('zigbee system without TDM','zigbee system with TDM','location','northwest');
figure(3);
subplot(2,1,1);
hold on;
grid on;
plot(x,wifi_delay,'-*r');
plot(x,wifi_delay2,'-ob');
legend('wifi system without TDM','wifi system with TDM','location','northwest');
xlabel('client number');
ylabel('Delay (s)');
subplot(2,1,2);
hold on;
grid on;
plot(x,zigbee_delay,'-*r');
plot(x,zigbee_delay2,'-ob');
legend('zigbee system without TDM','zigbee system with TDM','location','northwest');
xlabel('load(pk/s)');
ylabel('Delay (s)');
set(gca,'yscale','log');